var e,t;!function(e){e.FADE_IN="fadeIn",e.FADE_OUT="fadeOut"}(e||(e={})),function(e){e.OPENING="opening",e.OPENED="opened",e.CLOSING="closing",e.CLOSED="closed"}(t||(t={}));class i{constructor(e){this.enabledEvents=[],this.modalized=this.modalize(e),this.initialize()}show(){this.modalized.state===t.CLOSED&&(this.modalized.target.classList.add(this.modalized.config.animationIn),this.modalized.target.showModal(),this.modalized.target.setAttribute("opening",""),this.modalized.state=t.OPENING)}hide(){this.modalized.state===t.OPENED&&(this.modalized.target.classList.add(this.modalized.config.animationOut),this.modalized.target.setAttribute("closing",""),this.modalized.state=t.CLOSING)}destroy(){this.modalized.target.close(),this.enabledEvents.forEach((e=>{const{listener:t,eventType:i,action:s}=e;t.removeEventListener(i,s)})),this.modalized.target.parentElement?.removeChild(this.modalized.target)}modalize(e){const{element:i,trigger:s,config:a}=e;return{target:this.insertElementIntoModalizedTarget(i),trigger:s,config:a?{...this.defaultConfig(),...a}:this.defaultConfig(),state:t.CLOSED}}insertElementIntoModalizedTarget(e){const t=e?.parentElement||document.body,i=document.createElement("dialog");return i.classList.add("modalizer"),t.insertBefore(i,e),i.appendChild(e),i}initialize(){const{target:e,config:t}=this.modalized;this.enableEvent(e,"animationend",this.handleAnimationEvents.bind(this)),this.enableEvent(e,"cancel",this.handleCancelEvents.bind(this)),this.enableEvent(document,"keydown",this.handleKeydownEvents.bind(this)),t?.closer&&this.enableEvent(t.closer,"click",this.hide.bind(this)),this.modalized.trigger&&this.enableEvent(document,"click",this.handleClickEvents.bind(this)),t?.customClassName&&e.classList.add(t.customClassName),this.enabledEvents.forEach((e=>{const{listener:t,eventType:i,action:s}=e;t.addEventListener(i,s)})),this.modalized.target.classList.add("modalizer--initialized")}enableEvent(e,t,i){this.enabledEvents.push({listener:e,eventType:t,action:i})}handleClickEvents(e){const t=e.target;t&&t===this.modalized.trigger&&this.show()}handleKeydownEvents(e){"Escape"===e.code&&this.modalized.config.closeOnEscKeyPress&&this.hide()}handleAnimationEvents(e){const{pseudoElement:i}=e;i||(this.modalized.state!==t.OPENING?this.modalized.state!==t.CLOSING||this.setAsClosed():this.setAsOpened())}handleCancelEvents(e){e.preventDefault()}setAsOpened(){this.modalized.state===t.OPENING&&(this.modalized.target.removeAttribute("opening"),this.modalized.state=t.OPENED,this.modalized.target.classList.remove(this.modalized.config.animationIn))}setAsClosed(){this.modalized.state===t.CLOSING&&(this.modalized.target.close(),this.modalized.target.removeAttribute("closing"),this.modalized.state=t.CLOSED,this.modalized.target.classList.remove(this.modalized.config.animationOut))}defaultConfig(){return{animationIn:e.FADE_IN,animationOut:e.FADE_OUT,closeOnEscKeyPress:!0}}}export{i as Modalizer};